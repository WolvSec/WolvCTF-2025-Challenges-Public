#include "stdio.h"
#include "stdlib.h"
#include "string.h"

#define SIZE 96
const int START[] = {48, 48};
const int CHECKPOINTS[7][3] = {
    {0, 28, 34},
    {0, 35, 32},
    {1, 26, 15},
    {0, 20, 33},
    {1, 31, 17},
    {0, 60, 89},
    {0, 46, 51}
};
const int END[] = {0,44, 85};

struct State{
    int current_side;
    int x;
    int y;
    char sides[2][SIZE][SIZE];
};

struct State state = {
    .current_side = 0,
    .x = 48,
    .y = 48,
    .sides = 
    {
        {
            "..##############################################################################################",
            "################################################################################################",
            "################################################################################################",
            "################################################################################################",
            "################################################.###############################################",
            "#######################################..#.#....##....#...######################################",
            "######################################.###########..#.###..#####################################",
            "##################################.#....##.#.....#.....#.###.#.#################################",
            "##################################...#...##..#.#.###...#...#.#...#.#############################",
            "#############################.##.##..#...##.######.#.#.##..#..#....#.###########################",
            "##########################..#.#.......###..#.###.#..##.....##.#..##..###########################",
            "#########################.###...##...###.##.#.##.#.####.#.#.##..#...#..#########################",
            "#########################.#..#.###.#.#..#####..##...#..#.....#.......##.########################",
            "###########################..#.#...#.##.##.....####.#....##.#..#.##...###.######################",
            "#####################.#.#.#.#.............#.#.#.###..#...######..#......#.######################",
            "###################..##.#..#.##.##..#.##.#.#.####..#.#......###.####....###.#.##################",
            "#####################.##.##..##.##.#..######..#.#..#....#..#.#.######..##.##.#.#################",
            "###################...#.##.#####.#...#.#...#...#..#####.#....##.....#.#..##.#.##################",
            "################.....#.###...###.##.#..##..#@....######...####..#.###..##..##.#..###############",
            "################.##..###.#..#........#..#...@.#.##.#.#.#.....#@@@@@.#.####....###.##############",
            "################.##.#...#.#.##.......#..#...@...#..#.##.##....@..##.#.##...#.##...##############",
            "#################.###..#.##.#.#....#.#.....#@......@......@@@@##...#..#######.##..##############",
            "#############....##.##.#...##.###.##.#.....#@####.#@###.#...#@####.####....##...################",
            "############...#...#..##.##....#..#........#@.###..@##.#.....@#.##.###.###.#...#..#.############",
            "##############.##.#..#..#.##.#...###...#.#..@##..#.@#.#......@#..####.#..#.....####..###########",
            "###########..#.#..##.##..#.#..####.#.#......@#####.@.#.......@#..............#.#.####.##########",
            "##########.....######....#.#....##.....##...@..#.#.@.####.#.#@.####.###..#.#..#.#.###.##########",
            "##########.....###.#####.##.#...#...#.######@#.##..@#.######.@.#####.#..#.####.#.#.##..#########",
            "#########.#..#.#.#..##.#.....#..####.#..#.#.@#.#...@.....#...@...#.##.###.......#.#..###########",
            "#########.##.##.########@@@@@@@@@@@@@@@@@..#@##.###@..#....####.##.#..#.###......#.#..##########",
            "########.###.##...##..#...#.##.###@##...@...@@@@@@@@##..#.#.####..##..#####.####.##.###.########",
            "#########.#..##.###.......###..##.@#..##@.######...@.#.#.#....#........#.#########.....#########",
            "########.##.#...###..#..#####...#.@....#@##.####.##@.#.##..#.####@.#...#.#......#.#....#.#######",
            "########.#####..#....#.##.##.#####@#.#..@.#.###.###@@@@@@@@@@@@@@@@#.#.##.#....###.####..#######",
            "#########.#.#......##....#.###.#.#@#.#..@....###.#.@##.#....##.##@####.#.#...##...###..##.######",
            "######@@@@@@@@@@@@@@@@@##.#.###.##@#.###@.##.###.##@....##...#.##@#.##.#.##.###.######.##.######",
            "######@####...#..#.........#..####@...##@###..#####@#..#.#.#.#.#.@.#....##.#.#.#.##.#.##..######",
            "######@#..####.##....#..##.##.##..@...@#@@@@@@@@@@.@.....##.#####@...#.#..#.....##.#..#.#..#####",
            "######@....##..#.###.....#....#..#@#.#@#.#.##.###@#@#....#..#####@.#..###...####.#.....#..######",
            "######@.....#.########...##.#.###.@...@....#.#..#@.@#..#.#.......@#.##..##.##..##...#.##.#.#####",
            "######@@@@@@@....#.###....#.#..#..@..#@...#.#.#..@.@..#.#.#.##..#@#..#####.#.....##...##########",
            "#####.@#..#.@...###....#....##.##.@#.#@..##.####.@#@######.#.##..@.####.#######.#.###.....######",
            "######@.####@..#.#.#.##.##....##.##...@...####.##@####..#..##..##@#..#..######.#.##..#..###.####",
            "######@#..##@##.#..#..#..##.#.#@@@@@@@@@@@@@@#...@.###.#..###.###@#..#.#...##..##..#####.##.####",
            "#####.@..#.#@..##.....####....#.#.#..#@...##.#.##@#..###.#.#....#@######...###...##...##.#..####",
            "######@..#..@.###...#..#....##.##.####@.#.##.###.@###...#.###....@..#...##.#.###.#..##.#.#..####",
            "######@#####@@@@@.......#.#.###@##..##@####...##.@#.#.###.##.####@#...##.##.....##..#...#...####",
            "#####.@#.###..#.@###.##.#..##.#@#.####@.#..##.###@#.#..######.#.#@##..###..###.##.#.###.#.#.####",
            "#####.@#.###.##.@#.##.#######..@..##.#@.#...#####@###.###.#......@@@@@@@@@@@@@@#..#.##..##.#.###",
            "#####.@..#...#..@..#...#...####@##...#@@@@@@@...#@#.###.########.#.#...##....#.....#####....####",
            "######@...#...#.@#.##..######.#@#..#.##.#.#.@.#.#@@@@@@...###..##...#....#.#.#.##.#..##.#.#.####",
            "#####.#...@..#..@...###....#.#.@##..#.@@@###@##.#@..#.@..##..###.#..#..###......##.....#..######",
            "#######..#@#...#@@@@@......#...@.#.#@@@@@@@@@@@@@@####@#..#.#...#..#..##...#.#.#...########.####",
            "#####.##.#@#..#.....@#.#.####.#@..#.@#@...##@..#.##.##@.##....#....####.#....####..####.#.#.####",
            "#####.####@#####.#..@.###..####@.#.#@#@#....@@@@@@@@@@@#.....########...#.#####...#.###..#..####",
            "######...##.#..#.#..@##.####.##@..#.@#@#....@#.#.@###.@.@@@@####..##..#..#..##.##.###.#...#.####",
            "#####.#.##.#.###....@######..#.@.###@.@.#..#@####@.###@.##.@#.#.##..####.##.####.#..##.#.##.####",
            "########.#.##.....###......#..#@#...@@@@@@@@@@@@@@###.@#.#.@#...##..#.##.##.....##.###...##.####",
            "#######.#..#.#.#..##....#.#.##.@.@@@@@@@@@@@@###..#..#@#######.#..#.#.###..#.#.###.#.#.##.######",
            "##########.#...###..##.#.######@##.#@.@..#..#.#######.@####..#.###########..###.###.#####.######",
            "######@@@@@@@@@.####.###.#.#.#.@@@@@@@@@@@@@@@##.....#@@@@@@@@@@@@@##.#..##..#.#...#.####.######",
            "######.....##.......#.#.#####.##@##.@.@.##..#@.##.####@###....####..####..#.#.#...##..##.#######",
            "#######.##.#.#.....###..#...#..#@..#@.@.###..@####..#.@@@@@@@@@@@@@@@###.#..##...#...###..######",
            "#######.#.#.#.###.#....#.#...##.@##.@#@#.#.#.@##....###.#####..###.....#.##.#.#.#####...########",
            "########.##..#.##.#..#....###.#.@.##.#@...#..@##..####.#.#........#..#.###...#..##.#..#..#######",
            "##########.##..#.#.####...##..#.@.##..@##..##@#.##.#...##..#....#.##...@.......#.###..##########",
            "########.#####.##.#..##........#@...##@...#.#@###..#####.#.#.##.###...#@#.#.##..#.##.....#######",
            "#########.##..###..##.##.#....#..###..@#.###.@......###.####..###..#..#@.##.##.....#.#..########",
            "##########.#.....#...##.####.#.#....###.#.###@##..####..@@@@@@@@@@@@@@@@#..###..#.####..########",
            "##########.......#.##.#.#...###.#...#.###.##.@..#..#.#.####..#..@##.#...#....##.##....##########",
            "##########...#.####.###.#..@##....###..#.###.@.#.#...#.#.#.##..#@.#...#.###..##.################",
            "###########.###...#.###.###@....#.....#....#.@#.##@@@@@@@@@@@@@@@.......#.#....#.###.###########",
            "###############...#....##..@##..#.##.##.##.##@##.....#..###.###.#.#....##..##.....##############",
            "############.#.#@@@@@@@@@@@@.....##.##.#.....@@@@@@@@@@@@@@@###..#.#...#..#.....#..#############",
            "#############.#.@.######.####...##.###.#.##..#..##..##.###.....#..#..####.##.....###############",
            "###############.@.#.#.#######.##.#.#.###.....###.#.#.#.####...#.#.#.##.#####...#.###############",
            "###############.@#####..#########...#.#.###....##..#...#.#...##.##.#####....##..################",
            "###############.@#..#.#...#.####.#.....#.####...#######..#..##..#..#..##.#....##..##############",
            "################@..#.#...#...###..###.....###...#.#.....#.#.#.##.#.####.#...####################",
            "##################.#.#.#.#####..###.##.####.#.#....##....########.###...#.#..##.################",
            "###################.###..#...##.#####.#.#..#.##.#...####.####.##...#.##...#.####################",
            "#####################..####.##.#..##.#..####.#....#.###..##.####...######..#.###################",
            "######################..###...######...#######.###...##..##...##.#.##.#....#####################",
            "########################.#..#...#..###.#.##...##..#...######.##.....##.#.#.#####################",
            "#########################.#####......#####..#.######..#...#.#.#.#####.##.#######################",
            "#########################.##.#.####..#.#...#..##.#.#.######.##..##.####.########################",
            "##########################.####...#...###.#.#..##.#.##.##.##..#####..#.#########################",
            "##############################..#..####......#.#..##.#####..###.#...############################",
            "##############################..#..###.#.##.#####.##.#..#.##.###...#############################",
            "#################################.#...#.###...#.######.#...#..##################################",
            "####################################..###.#.#.###.#.#.#.#..#..##################################",
            "##########################################.#...##.##.##...######################################",
            "################################################################################################",
            "################################################################################################",
            "################################################################################################",
            "################################################################################################"
        },
        {
            "..##############################################################################################",
            "################################################################################################",
            "################################################################################################",
            "################################################################################################",
            "###############################################.################################################",
            "######################################..##......####.##.########################################",
            "####################################.....###...#.##.#....##..###################################",
            "################################..####....###....########.##.#.#################################",
            "#############################.#.###.#.#...#.#.....####.###.####..###############################",
            "###########################.###.#######..###.##..#..###....#...#.##.############################",
            "#########################.##...##..#######...###.###....#.#..######...##########################",
            "########################..###...#..##.#...#......##.##.#..###.##.####.##########################",
            "########################.#.#..#..##.#.##...#..##.####.......#.####...##..#######################",
            "#####################..#..##..#..#.#..####.#####.........#.##.......##..#.######################",
            "######################..###.#.##.#.###..##..#.##.###..####..#.####...##.#.######################",
            "##################...##.#.##...########.##...#..#..###.#....##.#.#...###.#...###################",
            "#################.#..#.##.##...#......####..##...#....##......#....#.#.##.##.###################",
            "################..#...##.##......#.#.##.##.###..###....#.....#####.##.#.#...####################",
            "###############..####..##.##.#..#..###......@.####..##.##....###..#...#.#..#.###################",
            "##############.#..##..#.#..#......#......###@#..##...##.#..#...#.#.#.#...#..###.################",
            "##############.....######.#....#.@.#.......#@.###.####.#.......##.#.#.#........#.###############",
            "##############..##....###.#..###.@#.#@@@@@@@@@@#..#....##..#.###....##..#.....###.##############",
            "############.#...#.#.#.....###..#@.#....#...##@..####.#.....##..##.##...#.....#..###############",
            "#############.##.####.######..#.#@....#....#..@##.#.#..#.##.#.#..##..##..##.....#...############",
            "###############...##...#.#.#.####@....###..###@###..#.....#####.#####.#...##.#...##.############",
            "##########......#...##.##..##.###@###..#.##...@.##..#.#.#...##.##.......##.##.#..##.############",
            "##########..##....#.#####..###...@#...#.######@##.#####..#...@....#.#.#....#.##..#.#############",
            "#########.#.##.###..#.#.#..#..#.#@.##.#####..#@..####..#.##.#@##....##.####...#.#.....##########",
            "########.##.....#..#.#.#..####.#.@@..###...###@#.######..#...@....#...###..#.#.###....##########",
            "########.#....#...#.#....#...#.##@@###.#.#.#..@###..##.######@#..##.##.#......#..#..#..#########",
            "########..#####...###.#.##...#.#.@@...##.#...#@#.#.##.#..#..####.#...#...#..##..######.#########",
            "#######..#....###....##.#.##.#..#@@##.#..#..##@#.##...#.#.#...##.#####...########....##.########",
            "#########.##.#####.###.#.###..###@@..##....###@.###.#####.#.#.#.#@.......#......#.......########",
            "#######.#..#.#.####....#..#@@@#.#@@##.##......@#..####...#.##.#..@....#.#.#..#.##....#...#######",
            "######.#..#...###..###.#.#...###.@@.##..#.#.##@.#...#...####..#..@....#.####.##.#.#.#..#########",
            "#####.#....#..#.#####.##..###@@@@@@....#.#.#.#@..##......@@@@@@@@@#.#.#...##@@@@@@@@@@@@@@######",
            "#####.#...#.##.##.###...#####.#..#@#...#..#.##@#......#..@....#.......##..##@.#....#.#.##.######",
            "#####.#####.#.#...#..#####.##.####@###.#..#...@#...#.###.@.#.#..#.##..#.####@...#...#.##..######",
            "#####.@.#.#..#.#.#.##..#.####..#..@#..##..###.#.##..###....#...##...#..#....@##..#..####..######",
            "####.#@###...#...####..##.#....#..@.#...#.....###..#.#######.#..#.###.#..#..@.....#.#...#.######",
            "######@#.#.########.##.##..#...###@.######..#####..##...#..#..#.....##..####@....#..#..##..#####",
            "####..@..##.##..#...##.....###....@@@@@@@@@@@@@@@@@##.....###.#...#..##....#@#.###.#...##..#####",
            "####.#@@@@@@@.....###...###..####.##...###..@##.##..##..####.##..#..#.#..#..@##..#..#.##.#.#####",
            "#####..#....@######..#..#.###.##..#.#####.#.@.@@@@@@####.###..##...##.##..##@#..##.#.#.#.#.#####",
            "####.###..##@.###..#########.....#.###.###..@#@###...#.@@@@@@@@@@#...#..#.#.@####.#..#..#..#####",
            "####.#.#.###@##..##...##...#...#.####.#..#.#@#@.#....#.....#...#@..#..####.#@.###....###...#####",
            "####.##...##@.###.####..##.#..#..#####.#..##@.@.....###.##......@....##.###.@..#.#...###...#####",
            "####.#....#.@###.#..##.###...#########....##@#@#..##..#.##...##.#@@@@@@@@@@@@..##..#..#.#.######",
            "#####...##.#@@@@@@#.#.#.##.##.##.....#...#..@#@@.....##..#.#####.@..........#..#####..#.#..#####",
            "####.##.#..#...##.#.#####..###..#####..#####@#@@..##.##.#.#######@#.##...#.##.##.....##.#.######",
            "####.#.##..#....##.#.###..#.#.#####.##...##.@.@@#...#.##..#.##..#@...#.##.##..##..#.###.#@######",
            "####.##..##....#####.##..###...#@@@@@@@@@@@@@.@@#...#.#.#...####.@##...#..#.#.....#.#.#..@.#####",
            "#####.##..#...#...#.#...####.#.#@#.#..#.###.#.@@#@@@@@@@@@@@@@@@@@..#...#.###...#..##..#.@######",
            "####...##.....#......###..###.#.@#.####.##.#..@@.@..#######.#...#@..##.#.#.#.#....####..#@.#####",
            "####.#..#.#.##.#...#####.#...#..@.#.##..###.##@@#@###.#.......##.@.#.####....####..#.@..#@.#####",
            "####.####..##.....##...#######..@..####@@@@@@@@@.@###.#..##...#@@@@@@@@@@@@#..#..##..@##.@.#####",
            "######...#..#.####..#..#.##...##@.#...#.....#..#.@###.#####.##.@.@.##.....@@.....##..@.#.@######",
            "####...###.####..#..#######.##.#@.##@#...#..#.#.#@##.#.#.##@@@@@@@@@@@@@@@@@##....###@@@@@.#####",
            "#####......##.##....#...#..#..#.@..#@###.#..#..#.@#...###.#.@#@@@@....##..#.###.#..##.##########",
            "#####.......#.#......#..##.#..##@...@..##..#...#.@.#.##...#.@#.@.##.##..###.#.###..##...#.######",
            "#####.##.##......###..##.###.###@#..@######.#..#.@..#.#..#..@#.@.#..#....@@@@@@@@@#.##.#..######",
            "#####...#.#..#....##.#..##..#.##@#.#@..##.######.@##...#..#.@.###.#...#.###.....#.....#..#######",
            "######..######.#..#####..###.#.#@..#@.#..#.#.#...@##..#.##..@.#...#...#..#..#.#...##.###########",
            "######.#.#.#..#..#.##.##.##.#...@.#.@......##.#.#@..##...###@.....##.#..##..###.....#.##########",
            "#######..##..##.#..#.......#.#.#@#..##.##.###.#.#@######..#.@#..#.....#..#....##....############",
            "#######.#.####....##.#....#.....@##...###.###...#@#.#.#.#...@#...#.#.#.@#..#.#..#.#.##..########",
            "#######....##..##..#.###.##.#...@.#.#.#.#.###.#.#@##..#..#.#@...##.#@@@@###...#....#.#..########",
            "########.##..#.#.####...#####...##..###...#...#.#@#..##.#@..@...##..@#.@...##...###.#.##########",
            "########..####.#....######.###..##.#.##@@@@@@@@@@@.#.#.##@.#@...@...@..@#...######...###########",
            "#########.#...#.#..##.##..#..##.###.##..###.###.##.......@#.@...@..#@#.@#...#..###.#.###########",
            "##########.#..#....####....##.######.#.#......###.#.#####@@@@@@@@@@@@@.@#..#...#....############",
            "##############..#..##..#####.###...###.##....@@@@@@@@@@@@@@@@###@##.#@.@####.....##..###########",
            "#############...#.##..####...##..###..###.#..##..#......#....#..@#...@.@.#.#.#..#..#############",
            "############..###.####..##.#..#@@@@@@##..#.####.##.#..###..#...#@####@#@.#.#.#.#.###############",
            "#################.##...#..###..@.....#..##.###.#....####..##..##@#.#.@.@#..##...#.##############",
            "##############..#.##.#.##...#..@..#..##.#.##...#.#.##..###.#.##.@..##@#@..###.#.################",
            "##################.#..#.##.##@@@...####.##...#..#.####..##...#..@#.##@.@.##.#.#.################",
            "##############....#.##..###....###...........###.#..##....#..#.#@.###@#@##...#..################",
            "#################.#.#.......#.##..#...#..###.##.##.#.##...#.##.#@@@@@@@@@@@@@@@@################",
            "#################..########..#####.#.####...#.#.#.###..##..#..#..##.#@.@#.#...##################",
            "#################.....#.#....#..####.....##.#####....###.#..#.#.#...#@@@....#.##################",
            "###################...##...###.#.###.....#.#..#......#.####..#......#.##...#.###################",
            "####################.#.##.#.#####..##..#..##..##...#.#..######.#.###...#.#######################",
            "#####################...#####.#.#.....#.#..##.##......#...#...##..#.#.##.#######################",
            "#######################.######.#.##......##..#.#.#.##..#.###.##...#.#.##.#######################",
            "#########################..#.#.##.#.....##.#.#.#...##...#..##...#..#.###########################",
            "#########################.#.#.#.#.#####.###.#.#.#.#######.##..####..############################",
            "###########################.##.###.#..###.######.##.#####..#..#..#..############################",
            "################################.#..#...#######.###...########.#################################",
            "################################.#..###...#.#.##.#.#####.##...##################################",
            "##################################.#...##..##...##.##......#####################################",
            "######################################..#.....#.#...###.########################################",
            "################################################################################################",
            "################################################################################################",
            "################################################################################################",
            "################################################################################################"
        }
    }
};


void check_checkpoint(int i){
    int index = (i/4) - 1;
    int err = 0;
    if(state.current_side != CHECKPOINTS[index][0]){
        err = 1;
    }
    if(state.x != CHECKPOINTS[index][1]){
        err = 1;
    }
    if(state.y != CHECKPOINTS[index][2]){
        err = 1;
    }

    if(err){
        puts("You're no DJ... get outta here >:(");
        exit(1);
    }
}

void rotate_cw(char matrix[SIZE][SIZE]){
    // Perform Transpose
    for (int i = 0; i < SIZE; i++) {
        for (int j = i + 1; j < SIZE; j++) {
            int temp = matrix[i][j];
            matrix[i][j] = matrix[j][i];
            matrix[j][i] = temp;
        }
    }

    // Reverse each row
    for (int i = 0; i < SIZE; i++) {
        int start = 0, end = SIZE - 1;
        while (start < end) {
            int temp = matrix[i][start];
            matrix[i][start] = matrix[i][end];
            matrix[i][end] = temp;
            start++;
            end--;
        }
    }
}

void rotate_ccw(char matrix[SIZE][SIZE]){
    // Reverse each row
    for (int i = 0; i < SIZE; i++) {
        int start = 0, end = SIZE - 1;
        while (start < end) {
            int temp = matrix[i][start];
            matrix[i][start] = matrix[i][end];
            matrix[i][end] = temp;
            start++;
            end--;
        }
    }

    // Perform Transpose
    for (int i = 0; i < SIZE; i++) {
        for (int j = i + 1; j < SIZE; j++) {
            int temp = matrix[i][j];
            matrix[i][j] = matrix[j][i];
            matrix[j][i] = temp;
        }
    }
}

void flip_matrix(char matrix[SIZE][SIZE]) {
    for (char i = 0; i < SIZE / 2; i++) {
        for (char j = 0; j < SIZE; j++) {
            char temp = matrix[i][j];
            matrix[i][j] = matrix[SIZE - i - 1][j];
            matrix[SIZE - i - 1][j] = temp;
        }
    }
}

void rotate_right(){
    //active side rotates cw
    rotate_cw(state.sides[state.current_side]);
    //backside rotates ccw
    rotate_ccw(state.sides[1-state.current_side]);
    //apply rotation matrix
    int tmpx = state.x;
    int tmpy = state.y;
    state.x = tmpy;
    state.y = 95-tmpx;
}

void rotate_left(){
    // active side rotates ccw
    rotate_ccw(state.sides[state.current_side]);
    // backside rotates cw
    rotate_cw(state.sides[1-state.current_side]);
    //apply rotation matrix
    int tmpx = state.x;
    int tmpy = state.y;
    state.x = 95-tmpy;
    state.y = tmpx;
}

void horizontal_flip(){
    //flip horizontal posiiton
    state.y = SIZE - 1 - state.y;
    //toggle active side
    state.current_side = 1 - state.current_side;

    //check for walls
    if(state.sides[state.current_side][state.x][state.y] == '#'){
        puts("You tryna glitch through walls or sum?");
        exit(1);
    }
}

void vertical_flip(){
    //flip vertical
    int tmpx = state.x;
    int tmpy = state.y;
    state.x = SIZE - 1 - tmpx;
    state.y = tmpy;
    //toggle active side
    state.current_side = 1 - state.current_side;
    //sides flip vertically
    flip_matrix(state.sides[state.current_side]);
    flip_matrix(state.sides[1 - state.current_side]);

    //check for walls
    if(state.sides[state.current_side][state.x][state.y] == '#'){
        puts("You tryna glitch through walls or sum?");
        exit(1);
    }
}

void do_command(char move){
    switch(move){
        case 0b00:
            //Rotate Right
            printf("RR ");
            rotate_right();
            break;
        case 0b11:
            //Rotate Left
            printf("RL ");
            rotate_left();
            break;
        case 0b10:
            //Vertical Flip
            printf("VF ");
            vertical_flip();
            break;
        case 0b01:
            //Horizontal Flip
            printf("HF ");
            horizontal_flip();
            break;
    }
}

void print_maze(){
    if(state.current_side == 0){
        printf("\nSIDE A\n");
        for(int i = 0; i < SIZE; i++){
            for(int j = 0; j < SIZE; j++){
                printf("%c",state.sides[0][i][j]);
            }
            printf("\n");
        }
        return;
    }


    printf("\nSIDE B\n");
    for(int i = 0; i < SIZE; i++){
        for(int j = 0; j < SIZE; j++){
            printf("%c",state.sides[1][i][j]);
        }
        printf("\n");
    }
}

void simulate(char* buf){
    print_maze();
    printf("Side = %d, pos = %d, %d\n",state.current_side,state.x,state.y);
    for(int i = 0; i < 32; i++){ //for every char
        if(i > 0 && i % 4 == 0){ //every 16 moves check checkpoint
            check_checkpoint(i);
        }
        char c = buf[i];
        for(int j = 0; j < 4; j++){ //for every command
            //grab move bits from char
            char move = (c >> 2*(3-j) ) & 0b11;

            //update orientation and position
            do_command(move);

            //tick gravity until you hit a wall
            state.sides[state.current_side][state.x][state.y] = 'X';
            while(1){
                int nextx = state.x + 1;
                if(state.sides[state.current_side][nextx][state.y] == '#'){
                    break;
                }
                state.x++;
                state.sides[state.current_side][state.x][state.y] = 'X';
            }
            int moven = i*4+j;
            printf("Move = %d,Side = %d, pos = %d, %d\n",moven,state.current_side,state.x,state.y);
            print_maze();
        }
    } //for every char

    //check ending position
    int err = 0;
    if(state.current_side != END[0]){
        err = 1;
    }
    if(state.x != END[1]){
        err = 1;
    }
    if(state.y != END[2]){
        err = 1;
    }
    if(err){
        puts("You're no DJ... You were close tho...");
        exit(1);
    }
}

void constrain_input(char* buf){
    int err = 0;
    if (strncmp(buf, "wctf", 4) != 0) {
        printf("1\n");
        err = 1;
    }
    
    // Checkpoint 1: info = ["{",0,0,'r']
    if (buf[4] != '{') {
        printf("2\n");
        err = 1;
    }
    
    if (buf[7] != 'r') {
        printf("3\n");
        err = 1;
    }
    
    // Checkpoint 2: info = [0,'t',0,'H']
    if (buf[9] != 't') {
        printf("4\n");
        err = 1;
    }
    
    if (buf[11] != 'H') {
        printf("5\n");
        err = 1;
    }
    
    // Checkpoint 3: info = ['1',0,'1',0]
    if (buf[12] != '1') {
        printf("6\n");
        err = 1;
    }
    
    if (buf[14] != '1') {
        printf("7\n");
        err = 1;
    }
    
    // Checkpoint 4: info = ['K',0,0,'4']
    if (buf[16] != 'K') {
        printf("8\n");
        err = 1;
    }
    
    if (buf[19] != '4') {
        printf("9\n");
        err = 1;
    }
    
    // Checkpoint 5: info = ['-',0,'3','3']
    if (buf[20] != '-') {
        printf("10\n");
        err = 1;
    }
    
    if (buf[22] != '3') {
        printf("11\n");
        err = 1;
    }
    
    if (buf[23] != '3') {
        printf("12\n");
        err = 1;
    }
    
    // Checkpoint 6: info = ['7','~','c',0]
    if (buf[24] != '7') {
        printf("13\n");
        err = 1;
    }
    
    if (buf[25] != '~') {
        printf("14\n");
        err = 1;
    }
    
    if (buf[26] != 'c') {
        printf("15\n");
        err = 1;
    }
    
    // Checkpoint 7: info = [0,0,'2','}']
    if (buf[30] != '2') {
        printf("16\n");
        err = 1;
    }
    
    if (buf[31] != '}') {
        printf("17\n");
        err = 1;
    }
    
    if(err){
        printf("Huh, how'd you end here? Perhaps the author could not figure out how to make the maze have a unique solution...\n");
        exit(1);
    }
    return;
}

int main(){
    char buf[40];
    fgets(buf, 33, stdin);
    buf[32] = '\0';
    if(strlen(buf) != 32){
        puts("You haven't even looked at the binary have you...");
        exit(1);
    }
    simulate(buf);
    constrain_input(buf);
    puts("That's a sick mix you just played! You win!");
    return 0;
}